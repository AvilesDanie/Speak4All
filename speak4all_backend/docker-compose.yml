version: "3.9"

services:
  api:
    build: .
    container_name: speak4all_api
    # Aqu√≠ puedes usar tanto variables directas como ${VAR} que vienen del .env
    environment:
      DATABASE_URL: ${DATABASE_URL}
      JWT_SECRET: ${JWT_SECRET}
      JWT_ALGORITHM: ${JWT_ALGORITHM}

      OPENAI_API_KEY: ${OPENAI_API_KEY}
      OPENAI_MODEL: ${OPENAI_MODEL}
      OPENAI_TTS_MODEL: ${OPENAI_TTS_MODEL}
      TTS_VOICE_NAME: ${TTS_VOICE_NAME}

      GOOGLE_APPLICATION_CREDENTIALS: ${GOOGLE_APPLICATION_CREDENTIALS}
      GCP_BUCKET_NAME: ${GCP_BUCKET_NAME}

      GOOGLE_CLIENT_ID: ${GOOGLE_CLIENT_ID}
      GOOGLE_CLIENT_SECRET: ${GOOGLE_CLIENT_SECRET}

    ports:
      - "8000:8000"

    volumes:
      # Carpeta media para archivos subidos
      - ./media:/code/media
      # Clave de GCP: el archivo local gcp-key.json se monta dentro del contenedor
      - ./gcp-key.json:/code/gcp-key.json:ro

    restart: unless-stopped
